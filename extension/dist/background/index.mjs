(function(){"use strict";var se=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ne(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var K={exports:{}};const de=e=>typeof crypto<"u"&&typeof crypto.getRandomValues=="function"?()=>{const t=crypto.getRandomValues(new Uint8Array(1))[0];return(t>=e?t%e:t).toString(e)}:()=>Math.floor(Math.random()*e).toString(e),te=(e=7,t=!1)=>Array.from({length:e},de(t?16:36)).join("");K.exports=te,K.exports.default=te;var ue=K.exports;const z=ne(ue);var fe=()=>`uid::${z(7)}`,xe=(e,t=["endpointName","fingerprint"])=>typeof e=="object"&&e!==null&&t.every(n=>n in e),pe=e=>{try{const t=JSON.parse(e);return xe(t)?t:null}catch{return null}},be=()=>{let e=[];return{add:(...t)=>{e=[...e,...t]},remove:t=>{e=typeof t=="string"?e.filter(n=>n.message.transactionId!==t):e.filter(n=>!t.includes(n))},entries:()=>e}},B=class{static toBackground(e,t){return e.postMessage(t)}static toExtensionContext(e,t){return e.postMessage(t)}},he=Object.defineProperty,we=Object.defineProperties,ye=Object.getOwnPropertyDescriptors,ie=Object.getOwnPropertySymbols,ve=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable,oe=(e,t,n)=>t in e?he(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,I=(e,t)=>{for(var n in t||(t={}))ve.call(t,n)&&oe(e,n,t[n]);if(ie)for(var n of ie(t))ke.call(t,n)&&oe(e,n,t[n]);return e},Y=(e,t)=>we(e,ye(t)),Ee=/^((?:background$)|devtools|popup|options|content-script|window)(?:@(\d+)(?:\.(\d+))?)?$/,Q=e=>{const[,t,n,A]=e.match(Ee)||[];return{context:t,tabId:+n,frameId:A?+A:void 0}},V=({context:e,tabId:t,frameId:n})=>["background","popup","options"].includes(e)?e:`${e}@${t}${n?`.${n}`:""}`;const Ce=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0}],X=Symbol(".toJSON was called"),Te=e=>{e[X]=!0;const t=e.toJSON();return delete e[X],t},ae=({from:e,seen:t,to_:n,forceEnumerable:A,maxDepth:c,depth:l})=>{const a=n||(Array.isArray(e)?[]:{});if(t.push(e),l>=c)return a;if(typeof e.toJSON=="function"&&e[X]!==!0)return Te(e);for(const[g,d]of Object.entries(e)){if(typeof Buffer=="function"&&Buffer.isBuffer(d)){a[g]="[object Buffer]";continue}if(d!==null&&typeof d=="object"&&typeof d.pipe=="function"){a[g]="[object Stream]";continue}if(typeof d!="function"){if(!d||typeof d!="object"){a[g]=d;continue}if(!t.includes(e[g])){l++,a[g]=ae({from:e[g],seen:[...t],forceEnumerable:A,maxDepth:c,depth:l});continue}a[g]="[Circular]"}}for(const{property:g,enumerable:d}of Ce)typeof e[g]=="string"&&Object.defineProperty(a,g,{value:e[g],enumerable:A?!0:d,configurable:!0,writable:!0});return a};function Se(e,t={}){const{maxDepth:n=Number.POSITIVE_INFINITY}=t;return typeof e=="object"&&e!==null?ae({from:e,seen:[],forceEnumerable:!0,maxDepth:n,depth:0}):typeof e=="function"?`[Function: ${e.name||"anonymous"}]`:e}let ge=()=>({events:{},emit(e,...t){(this.events[e]||[]).forEach(n=>n(...t))},on(e,t){return(this.events[e]=this.events[e]||[]).push(t),()=>this.events[e]=(this.events[e]||[]).filter(n=>n!==t)}});var _e=(e,t,n)=>{const A=z(),c=new Map,l=new Map,a=g=>{if(g.destination.context===e&&!g.destination.frameId&&!g.destination.tabId){n==null||n(g);const{transactionId:d,messageID:v,messageType:p}=g,T=()=>{const k=c.get(d);if(k){const{err:w,data:C}=g;if(w){const E=w,N=self[E.name],j=new(typeof N=="function"?N:Error)(E.message);for(const O in E)j[O]=E[O];k.reject(j)}else k.resolve(C);c.delete(d)}},_=async()=>{let k,w,C=!1;try{const E=l.get(v);if(typeof E=="function")k=await E({sender:g.origin,id:v,data:g.data,timestamp:g.timestamp});else throw C=!0,new Error(`[webext-bridge] No handler registered in '${e}' to accept messages with id '${v}'`)}catch(E){w=E}finally{if(w&&(g.err=Se(w)),a(Y(I({},g),{messageType:"reply",data:k,origin:{context:e,tabId:null},destination:g.origin,hops:[]})),w&&!C)throw k}};switch(p){case"reply":return T();case"message":return _()}}return g.hops.push(`${e}::${A}`),t(g)};return{handleMessage:a,endTransaction:g=>{const d=c.get(g);d==null||d.reject("Transaction was ended before it could complete"),c.delete(g)},sendMessage:(g,d,v="background")=>{const p=typeof v=="string"?Q(v):v,T="Bridge#sendMessage ->";if(!p.context)throw new TypeError(`${T} Destination must be any one of known destinations`);return new Promise((_,k)=>{const w={messageID:g,data:d,destination:p,messageType:"message",transactionId:z(),origin:{context:e,tabId:null},hops:[],timestamp:Date.now()};c.set(w.transactionId,{resolve:_,reject:k});try{a(w)}catch(C){c.delete(w.transactionId),k(C)}})},onMessage:(g,d)=>(l.set(g,d),()=>l.delete(g))}},D=class{constructor(e,t){this.endpointRuntime=e,this.streamInfo=t,this.emitter=ge(),this.isClosed=!1,this.handleStreamClose=()=>{this.isClosed||(this.isClosed=!0,this.emitter.emit("closed",!0),this.emitter.events={})},D.initDone||(e.onMessage("__crx_bridge_stream_transfer__",n=>{const{streamId:A,streamTransfer:c,action:l}=n.data,a=D.openStreams.get(A);a&&!a.isClosed&&(l==="transfer"&&a.emitter.emit("message",c),l==="close"&&(D.openStreams.delete(A),a.handleStreamClose()))}),D.initDone=!0),D.openStreams.set(this.streamInfo.streamId,this)}get info(){return this.streamInfo}send(e){if(this.isClosed)throw new Error("Attempting to send a message over closed stream. Use stream.onClose(<callback>) to keep an eye on stream status");this.endpointRuntime.sendMessage("__crx_bridge_stream_transfer__",{streamId:this.streamInfo.streamId,streamTransfer:e,action:"transfer"},this.streamInfo.endpoint)}close(e){e&&this.send(e),this.handleStreamClose(),this.endpointRuntime.sendMessage("__crx_bridge_stream_transfer__",{streamId:this.streamInfo.streamId,streamTransfer:null,action:"close"},this.streamInfo.endpoint)}onMessage(e){return this.getDisposable("message",e)}onClose(e){return this.getDisposable("closed",e)}getDisposable(e,t){const n=this.emitter.on(e,t);return Object.assign(n,{dispose:n,close:n})}},Z=D;Z.initDone=!1,Z.openStreams=new Map;var Pe=e=>{const t=new Map,n=new Map,A=ge();e.onMessage("__crx_bridge_stream_open__",a=>new Promise(g=>{const{sender:d,data:v}=a,{channel:p}=v;let T=!1,_=()=>{};const k=()=>{const w=n.get(p);typeof w=="function"?(w(new Z(e,Y(I({},v),{endpoint:d}))),T&&_(),g(!0)):T||(T=!0,_=A.on("did-change-stream-callbacks",k))};k()}));async function c(a,g){if(t.has(a))throw new Error("webext-bridge: A Stream is already open at this channel");const d=typeof g=="string"?Q(g):g,v={streamId:z(),channel:a,endpoint:d},p=new Z(e,v);return p.onClose(()=>t.delete(a)),await e.sendMessage("__crx_bridge_stream_open__",v,d),t.set(a,p),p}function l(a,g){if(n.has(a))throw new Error("webext-bridge: This channel has already been claimed. Stream allows only one-on-one communication");n.set(a,g),A.emit("did-change-stream-callbacks")}return{openStream:c,onOpenStreamChannel:l}},me={exports:{}};(function(e,t){(function(n,A){A(e)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:se,function(n){if(typeof globalThis!="object"||typeof chrome!="object"||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const A="The message port closed before a response was received.",c="Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)",l=a=>{const g={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(g).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class d extends WeakMap{constructor(s,o=void 0){super(o),this.createItem=s}get(s){return this.has(s)||this.set(s,this.createItem(s)),super.get(s)}}const v=r=>r&&typeof r=="object"&&typeof r.then=="function",p=(r,s)=>(...o)=>{a.runtime.lastError?r.reject(new Error(a.runtime.lastError.message)):s.singleCallbackArg||o.length<=1&&s.singleCallbackArg!==!1?r.resolve(o[0]):r.resolve(o)},T=r=>r==1?"argument":"arguments",_=(r,s)=>function(m,...f){if(f.length<s.minArgs)throw new Error(`Expected at least ${s.minArgs} ${T(s.minArgs)} for ${r}(), got ${f.length}`);if(f.length>s.maxArgs)throw new Error(`Expected at most ${s.maxArgs} ${T(s.maxArgs)} for ${r}(), got ${f.length}`);return new Promise((x,b)=>{if(s.fallbackToNoCallback)try{m[r](...f,p({resolve:x,reject:b},s))}catch(i){console.warn(`${r} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,i),m[r](...f),s.fallbackToNoCallback=!1,s.noCallback=!0,x()}else s.noCallback?(m[r](...f),x()):m[r](...f,p({resolve:x,reject:b},s))})},k=(r,s,o)=>new Proxy(s,{apply(m,f,x){return o.call(f,r,...x)}});let w=Function.call.bind(Object.prototype.hasOwnProperty);const C=(r,s={},o={})=>{let m=Object.create(null),f={has(b,i){return i in r||i in m},get(b,i,h){if(i in m)return m[i];if(!(i in r))return;let u=r[i];if(typeof u=="function")if(typeof s[i]=="function")u=k(r,r[i],s[i]);else if(w(o,i)){let P=_(i,o[i]);u=k(r,r[i],P)}else u=u.bind(r);else if(typeof u=="object"&&u!==null&&(w(s,i)||w(o,i)))u=C(u,s[i],o[i]);else if(w(o,"*"))u=C(u,s[i],o["*"]);else return Object.defineProperty(m,i,{configurable:!0,enumerable:!0,get(){return r[i]},set(P){r[i]=P}}),u;return m[i]=u,u},set(b,i,h,u){return i in m?m[i]=h:r[i]=h,!0},defineProperty(b,i,h){return Reflect.defineProperty(m,i,h)},deleteProperty(b,i){return Reflect.deleteProperty(m,i)}},x=Object.create(r);return new Proxy(x,f)},E=r=>({addListener(s,o,...m){s.addListener(r.get(o),...m)},hasListener(s,o){return s.hasListener(r.get(o))},removeListener(s,o){s.removeListener(r.get(o))}}),N=new d(r=>typeof r!="function"?r:function(o){const m=C(o,{},{getContent:{minArgs:0,maxArgs:0}});r(m)});let j=!1;const O=new d(r=>typeof r!="function"?r:function(o,m,f){let x=!1,b,i=new Promise(M=>{b=function(y){j||(console.warn(c,new Error().stack),j=!0),x=!0,M(y)}}),h;try{h=r(o,m,b)}catch(M){h=Promise.reject(M)}const u=h!==!0&&v(h);if(h!==!0&&!u&&!x)return!1;const P=M=>{M.then(y=>{f(y)},y=>{let F;y&&(y instanceof Error||typeof y.message=="string")?F=y.message:F="An unexpected error occurred",f({__mozWebExtensionPolyfillReject__:!0,message:F})}).catch(y=>{console.error("Failed to send onMessage rejected reply",y)})};return P(u?h:i),!0}),ee=({reject:r,resolve:s},o)=>{a.runtime.lastError?a.runtime.lastError.message===A?s():r(new Error(a.runtime.lastError.message)):o&&o.__mozWebExtensionPolyfillReject__?r(new Error(o.message)):s(o)},q=(r,s,o,...m)=>{if(m.length<s.minArgs)throw new Error(`Expected at least ${s.minArgs} ${T(s.minArgs)} for ${r}(), got ${m.length}`);if(m.length>s.maxArgs)throw new Error(`Expected at most ${s.maxArgs} ${T(s.maxArgs)} for ${r}(), got ${m.length}`);return new Promise((f,x)=>{const b=ee.bind(null,{resolve:f,reject:x});m.push(b),o.sendMessage(...m)})},re={devtools:{network:{onRequestFinished:E(N)}},runtime:{onMessage:E(O),onMessageExternal:E(O),sendMessage:q.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:q.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},$={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return g.privacy={network:{"*":$},services:{"*":$},websites:{"*":$}},C(a,re,g)};n.exports=l(chrome)}else n.exports=globalThis.browser})})(me);var Me=me.exports;const Ie=ne(Me);var W=be(),S=new Map,L=new Map,G=new Map,le=(e,t)=>(L.set(e,(L.get(e)||new Set).add(t)),()=>{const n=L.get(e);n!=null&&n.delete(t)&&(n==null?void 0:n.size)===0&&L.delete(e)}),Ae=(e,t)=>{G.set(e,(G.get(e)||new Set).add(t))},R=e=>({withFingerprint:t=>{const n=c=>({and:()=>c}),A={aboutIncomingMessage:c=>{const l=S.get(e);return B.toExtensionContext(l.port,{status:"incoming",message:c}),n(A)},aboutSuccessfulDelivery:c=>{const l=S.get(e);return B.toExtensionContext(l.port,{status:"delivered",receipt:c}),n(A)},aboutMessageUndeliverability:(c,l)=>{const a=S.get(e);return(a==null?void 0:a.fingerprint)===t&&B.toExtensionContext(a.port,{status:"undeliverable",resolvedDestination:c,message:l}),n(A)},whenDeliverableTo:c=>{const l=()=>{const a=S.get(e);if((a==null?void 0:a.fingerprint)===t&&S.has(c))return B.toExtensionContext(a.port,{status:"deliverable",deliverableTo:c}),!0};if(!l()){const a=le(c,l);Ae(t,a)}return n(A)},aboutSessionEnded:c=>{const l=S.get(e);return(l==null?void 0:l.fingerprint)===t&&B.toExtensionContext(l.port,{status:"terminated",fingerprint:c}),n(A)}};return A}}),Ne=fe(),J=_e("background",e=>{var t;if(e.origin.context==="background"&&["content-script","devtools "].includes(e.destination.context)&&!e.destination.tabId)throw new TypeError("When sending messages from background page, use @tabId syntax to target specific tab");const n=V(I(I({},e.origin),e.origin.context==="window"&&{context:"content-script"})),A=V(Y(I(I({},e.destination),e.destination.context==="window"&&{context:"content-script"}),{tabId:e.destination.tabId||e.origin.tabId}));e.destination.tabId=null,e.destination.frameId=null;const c=()=>S.get(A),l=()=>S.get(n),a=()=>{var g;R(A).withFingerprint(c().fingerprint).aboutIncomingMessage(e);const d={message:e,to:c().fingerprint,from:{endpointId:n,fingerprint:(g=l())==null?void 0:g.fingerprint}};e.messageType==="message"&&W.add(d),e.messageType==="reply"&&W.remove(e.messageID),l()&&R(n).withFingerprint(l().fingerprint).aboutSuccessfulDelivery(d)};(t=c())!=null&&t.port?a():e.messageType==="message"&&(e.origin.context==="background"?le(A,a):l()&&R(n).withFingerprint(l().fingerprint).aboutMessageUndeliverability(A,e).and().whenDeliverableTo(A))},e=>{const t=V(I(I({},e.origin),e.origin.context==="window"&&{context:"content-script"})),n=S.get(t),A={message:e,to:Ne,from:{endpointId:t,fingerprint:n.fingerprint}};R(t).withFingerprint(n.fingerprint).aboutSuccessfulDelivery(A)});Ie.runtime.onConnect.addListener(e=>{var t;const n=pe(e.name);if(!n)return;n.endpointName||(n.endpointName=V({context:"content-script",tabId:e.sender.tab.id,frameId:e.sender.frameId}));const{tabId:A,frameId:c}=Q(n.endpointName);S.set(n.endpointName,{fingerprint:n.fingerprint,port:e}),(t=L.get(n.endpointName))==null||t.forEach(l=>l()),L.delete(n.endpointName),Ae(n.fingerprint,()=>{const l=W.entries().filter(a=>a.to===n.fingerprint);W.remove(l),l.forEach(a=>{a.from.endpointId==="background"?J.endTransaction(a.message.transactionId):R(a.from.endpointId).withFingerprint(a.from.fingerprint).aboutSessionEnded(n.fingerprint)})}),e.onDisconnect.addListener(()=>{var l,a;((l=S.get(n.endpointName))==null?void 0:l.fingerprint)===n.fingerprint&&S.delete(n.endpointName),(a=G.get(n.fingerprint))==null||a.forEach(g=>g()),G.delete(n.fingerprint)}),e.onMessage.addListener(l=>{var a,g;if(l.type==="sync"){const d=[...S.values()].map(p=>p.fingerprint),v=l.pendingResponses.filter(p=>d.includes(p.to));W.add(...v),l.pendingResponses.filter(p=>!d.includes(p.to)).forEach(p=>R(n.endpointName).withFingerprint(n.fingerprint).aboutSessionEnded(p.to)),l.pendingDeliveries.forEach(p=>R(n.endpointName).withFingerprint(n.fingerprint).whenDeliverableTo(p));return}l.type==="deliver"&&((g=(a=l.message)==null?void 0:a.origin)!=null&&g.context)&&(l.message.origin.tabId=A,l.message.origin.frameId=c,J.handleMessage(l.message))})});var{sendMessage:Oe,onMessage:Re}=J;Pe(J);var ce={exports:{}};(function(e,t){(function(n,A){A(e)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:se,function(n){var A,c;if(!((c=(A=globalThis.chrome)==null?void 0:A.runtime)!=null&&c.id))throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const l="The message port closed before a response was received.",a=g=>{const d={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(d).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class v extends WeakMap{constructor(s,o=void 0){super(o),this.createItem=s}get(s){return this.has(s)||this.set(s,this.createItem(s)),super.get(s)}}const p=r=>r&&typeof r=="object"&&typeof r.then=="function",T=(r,s)=>(...o)=>{g.runtime.lastError?r.reject(new Error(g.runtime.lastError.message)):s.singleCallbackArg||o.length<=1&&s.singleCallbackArg!==!1?r.resolve(o[0]):r.resolve(o)},_=r=>r==1?"argument":"arguments",k=(r,s)=>function(m,...f){if(f.length<s.minArgs)throw new Error(`Expected at least ${s.minArgs} ${_(s.minArgs)} for ${r}(), got ${f.length}`);if(f.length>s.maxArgs)throw new Error(`Expected at most ${s.maxArgs} ${_(s.maxArgs)} for ${r}(), got ${f.length}`);return new Promise((x,b)=>{if(s.fallbackToNoCallback)try{m[r](...f,T({resolve:x,reject:b},s))}catch(i){console.warn(`${r} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,i),m[r](...f),s.fallbackToNoCallback=!1,s.noCallback=!0,x()}else s.noCallback?(m[r](...f),x()):m[r](...f,T({resolve:x,reject:b},s))})},w=(r,s,o)=>new Proxy(s,{apply(m,f,x){return o.call(f,r,...x)}});let C=Function.call.bind(Object.prototype.hasOwnProperty);const E=(r,s={},o={})=>{let m=Object.create(null),f={has(b,i){return i in r||i in m},get(b,i,h){if(i in m)return m[i];if(!(i in r))return;let u=r[i];if(typeof u=="function")if(typeof s[i]=="function")u=w(r,r[i],s[i]);else if(C(o,i)){let P=k(i,o[i]);u=w(r,r[i],P)}else u=u.bind(r);else if(typeof u=="object"&&u!==null&&(C(s,i)||C(o,i)))u=E(u,s[i],o[i]);else if(C(o,"*"))u=E(u,s[i],o["*"]);else return Object.defineProperty(m,i,{configurable:!0,enumerable:!0,get(){return r[i]},set(P){r[i]=P}}),u;return m[i]=u,u},set(b,i,h,u){return i in m?m[i]=h:r[i]=h,!0},defineProperty(b,i,h){return Reflect.defineProperty(m,i,h)},deleteProperty(b,i){return Reflect.deleteProperty(m,i)}},x=Object.create(r);return new Proxy(x,f)},N=r=>({addListener(s,o,...m){s.addListener(r.get(o),...m)},hasListener(s,o){return s.hasListener(r.get(o))},removeListener(s,o){s.removeListener(r.get(o))}}),j=new v(r=>typeof r!="function"?r:function(o){const m=E(o,{},{getContent:{minArgs:0,maxArgs:0}});r(m)}),O=new v(r=>typeof r!="function"?r:function(o,m,f){let x=!1,b,i=new Promise(M=>{b=function(y){x=!0,M(y)}}),h;try{h=r(o,m,b)}catch(M){h=Promise.reject(M)}const u=h!==!0&&p(h);if(h!==!0&&!u&&!x)return!1;const P=M=>{M.then(y=>{f(y)},y=>{let F;y&&(y instanceof Error||typeof y.message=="string")?F=y.message:F="An unexpected error occurred",f({__mozWebExtensionPolyfillReject__:!0,message:F})}).catch(y=>{console.error("Failed to send onMessage rejected reply",y)})};return P(u?h:i),!0}),ee=({reject:r,resolve:s},o)=>{g.runtime.lastError?g.runtime.lastError.message===l?s():r(new Error(g.runtime.lastError.message)):o&&o.__mozWebExtensionPolyfillReject__?r(new Error(o.message)):s(o)},q=(r,s,o,...m)=>{if(m.length<s.minArgs)throw new Error(`Expected at least ${s.minArgs} ${_(s.minArgs)} for ${r}(), got ${m.length}`);if(m.length>s.maxArgs)throw new Error(`Expected at most ${s.maxArgs} ${_(s.maxArgs)} for ${r}(), got ${m.length}`);return new Promise((f,x)=>{const b=ee.bind(null,{resolve:f,reject:x});m.push(b),o.sendMessage(...m)})},re={devtools:{network:{onRequestFinished:N(j)}},runtime:{onMessage:N(O),onMessageExternal:N(O),sendMessage:q.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:q.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},$={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return d.privacy={network:{"*":$},services:{"*":$},websites:{"*":$}},E(g,re,d)};n.exports=a(chrome)}else n.exports=globalThis.browser})})(ce);var H=ce.exports;H.runtime.onInstalled.addListener(()=>{console.log("Extension installed")});let U=0;H.tabs.onActivated.addListener(async({tabId:e})=>{if(!U){U=e;return}let t;try{t=await H.tabs.get(U),U=e}catch{return}console.log("previous tab",t),Oe("tab-prev",{title:t.title},{context:"content-script",tabId:e})}),Re("get-current-tab",async()=>{try{const e=await H.tabs.get(U);return{title:e==null?void 0:e.title}}catch{return{title:void 0}}})})();
