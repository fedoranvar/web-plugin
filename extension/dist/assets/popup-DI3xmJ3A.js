import{o as c,c as s,b as a,h as N,j as D,d as B,a as u,w as b,k as f,u as i,i as _,l as g,f as y,m as v,n as w,p as C,q as I,e as T,_ as E,g as M,s as U}from"./__uno-kBCfFscz.js";const O={viewBox:"0 0 20 20",width:"1.2em",height:"1.2em"},R=a("path",{fill:"currentColor",d:"m4.878.282l.348 1.071A2.206 2.206 0 0 0 6.624 2.75l1.072.348l.022.006a.423.423 0 0 1 0 .798l-1.072.348a2.208 2.208 0 0 0-1.399 1.397L4.9 6.717a.423.423 0 0 1-.798 0l-.348-1.07a2.204 2.204 0 0 0-1.399-1.403l-1.072-.348a.423.423 0 0 1 0-.798l1.072-.348a2.208 2.208 0 0 0 1.377-1.397L4.08.283a.423.423 0 0 1 .799 0m4.905 7.931l-.766-.248a1.577 1.577 0 0 1-.998-.999l-.25-.764a.302.302 0 0 0-.57 0l-.248.764a1.575 1.575 0 0 1-.984.999l-.765.248a.302.302 0 0 0 0 .57l.765.249a1.577 1.577 0 0 1 1 1.002l.248.764a.302.302 0 0 0 .57 0l.249-.764a1.575 1.575 0 0 1 .999-.999l.765-.248a.302.302 0 0 0 0-.57zm-3.768 2.134l.207.637l-1.97 1.97a1.438 1.438 0 0 0-.386.705l-.707 3.182l3.159-.702c.282-.063.54-.205.744-.409l9.358-9.358a1.975 1.975 0 0 0-2.793-2.792L9.965 7.242l-.637-.21a.678.678 0 0 1-.23-.14a.418.418 0 0 1-.088-.11l3.91-3.91a2.975 2.975 0 0 1 4.207 4.207l-.67.67l.336.337a2 2 0 0 1 0 2.828l-.94.94a.5.5 0 0 1-.707-.708l.94-.939a1 1 0 0 0 0-1.414l-.336-.336l-7.98 7.98a2.519 2.519 0 0 1-1.235.678l-3.926.873a.5.5 0 0 1-.597-.596l.878-3.95c.1-.453.328-.867.655-1.195l2.212-2.211a.607.607 0 0 1 .258.311"},null,-1),j=[R];function z(n,e){return c(),s("svg",O,[...j])}const F={name:"fluent-pen-sparkle20-regular",render:z},H={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},J=a("path",{fill:"currentColor",d:"M12 2a1 1 0 0 1 1 1v10.586l2.293-2.293a1 1 0 0 1 1.414 1.414l-4 4a1 1 0 0 1-1.414 0l-4-4a1 1 0 1 1 1.414-1.414L11 13.586V3a1 1 0 0 1 1-1M5 17a1 1 0 0 1 1 1v2h12v-2a1 1 0 1 1 2 0v2a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-2a1 1 0 0 1 1-1"},null,-1),K=[J];function W(n,e){return c(),s("svg",H,[...K])}const G={name:"mi-download",render:W},Q={viewBox:"0 0 1792 1792",width:"1.2em",height:"1.2em"},X=a("path",{fill:"currentColor",d:"M1764 11q33 24 27 64l-256 1536q-5 29-32 45q-14 8-31 8q-11 0-24-5l-453-185l-242 295q-18 23-49 23q-13 0-22-4q-19-7-30.5-23.5T640 1728v-349l864-1059l-1069 925l-395-162q-37-14-40-55q-2-40 32-59L1696 9q15-9 32-9q20 0 36 11"},null,-1),Y=[X];function Z(n,e){return c(),s("svg",Q,[...Y])}const ee={name:"fa-send",render:Z},ne="/dist/assets/logo_docs-Dfl_1JKt.png",te={},oe={id:"logo",src:ne};function re(n,e){return c(),s("img",oe)}const ae=N(te,[["render",re]]),le={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},de=a("g",{fill:"currentColor"},[a("path",{d:"M12 4a1 1 0 0 0-1 1c0 1.692-2.046 2.54-3.243 1.343a1 1 0 1 0-1.414 1.414C7.54 8.954 6.693 11 5 11a1 1 0 1 0 0 2c1.692 0 2.54 2.046 1.343 3.243a1 1 0 0 0 1.414 1.414C8.954 16.46 11 17.307 11 19a1 1 0 1 0 2 0c0-1.692 2.046-2.54 3.243-1.343a1 1 0 1 0 1.414-1.414C16.46 15.046 17.307 13 19 13a1 1 0 1 0 0-2c-1.692 0-2.54-2.046-1.343-3.243a1 1 0 0 0-1.414-1.414C15.046 7.54 13 6.693 13 5a1 1 0 0 0-1-1m-2.992.777a3 3 0 0 1 5.984 0a3 3 0 0 1 4.23 4.231a3 3 0 0 1 .001 5.984a3 3 0 0 1-4.231 4.23a3 3 0 0 1-5.984 0a3 3 0 0 1-4.231-4.23a3 3 0 0 1 0-5.984a3 3 0 0 1 4.231-4.231"}),a("path",{d:"M12 10a2 2 0 1 0 0 4a2 2 0 0 0 0-4m-2.828-.828a4 4 0 1 1 5.656 5.656a4 4 0 0 1-5.656-5.656"})],-1),ie=[de];function ce(n,e){return c(),s("svg",le,[...ie])}const se={name:"mi-settings",render:ce};function L(){const n=document.querySelector(".right-side");if(n===null)return setTimeout(L,1e3);const e=document.createElement("div"),r=me(),t=$("advanceSettingIndexInput","Индекс"),o=$("advanceSettingTypeInput","Тип"),d=$("advanceSettingPwdInput","ПИН");d.type="password";const p=ge(r),k=_e(r,t,o,d),x=fe(r),m=h();m.className="btn btn_custom btn_accent btn-icon btn-icon_settings";var l=!1;m.onclick=function(Ie){l?(t.style.display="none",o.style.display="none",d.style.display="none"):(t.style.display="inline",o.style.display="inline",d.style.display="inline"),l=!l},e.style="margin-top:5px;margin-left:5px;",e.appendChild(r),e.appendChild(p),e.appendChild(k),e.appendChild(x),e.appendChild(m),e.appendChild(t),e.appendChild(o),e.appendChild(d),n.parentElement.appendChild(e)}function S(n){if(!n)return alert("Укажите корректную ссылку.");const e=new URL(n);return{origin:e.origin,documentToken:e.searchParams.get("document_token"),documentId:e.searchParams.get("document_id"),documentType:e.searchParams.get("document_type")}}function ue(n){var e=window.open(n,"_blank");e.focus(),logo_docs}function P(n,e,r="Действие успешно выполнено!"){const t=S(n);if(console.log("===== URLPARAMS: ",t),!t.documentToken||!t.documentId||!t.documentType)return alert("Указана не корректная ссылка.");try{return e=Object.assign({id:String(t.documentId),locationOrigin:t.origin,advanceType:t.documentType,document_token:t.documentToken,mode:"applications",module:"ds",isSrd:!0},e),D.runtime.sendMessage(e).then(o=>{o.done?(o.documentFgisData&&(console.log("data :>> ",o),ue(o.documentFgisData.url)),alert(r)):(o.err=o.err.replace("Token is expiredОшибка в адвансе","Срок действия ссылки истек"),o.err=o.err.replace("Token not foundОшибка в адвансе","Указана не корректная ссылка"),alert(o.err)),btn1.style.display="inline"})}catch(o){console.log("activeAction error:>> ",n,e,r,o)}}function A(n){return console.log("sendDocument :>> ",n),P(n,{action:"saveDeclarationDs"},"Документ успешно выгружен и открыт в новой вкладке.")}function pe(n,e,r,t){const o=e.value,d=r.value,p=t.value||"";if(!o||!d&&d!==0){alert("Поля Индекс и Тип обязательны к заполнению");return}return P(n,{action:"signDeclaration",settings:{indexCertif:o,algorithm:d,pwdCertif:p}},"Документ успешно опубликован.")}function me(){const n=q();return n.placeholder="Укажите Advance ссылку на документ...",n.id="advanceLinkInput",n}function $(n,e){const r=q(!1);return r.placeholder=e,r.id=n,r.style="max-width:75px;margin-left:5px;",r.style.display="none",r.value=localStorage.getItem(r.id)||"",r.onchange=function(t){localStorage.setItem(r.id,r.value)},r}function q(n=!0){const e=document.createElement("input");return n&&(e.style="min-width:275px;margin-left:5px;"),e}function ge(n){const e=h();return e.id="btnSubmit",e.innerText="Отправить",e.onclick=function(r){return A(n.value)},e}function be(n){const e=S(n);let r=`${e.origin}/api/v3/fgis/${e.documentType}/document/download/${e.documentId}?document_token=${e.documentToken}`;console.log("=== DOWNLOAD: ",r),window.open(r)}function fe(n){const e=h();return e.id="btnDownload",e.innerText="Скачать",e.onclick=function(r){const t=S(n.value);let o=document.createElement("a");o.href=`${t.origin}/api/v3/fgis/${t.documentType}/document/download/${t.documentId}?document_token=${t.documentToken}`,o.download="Декларация.zip",document.body.appendChild(o),o.click(),document.body.removeChild(o)},e}function _e(n,e,r,t){const o=h();return o.id="btnSign",o.innerText="Подписать",o.onclick=function(d){return pe(n.value,e,r,t)},o}function h(n=!0){let e=document.createElement("button");return e.className="btn btn_custom btn-primary btn-icon",n&&(e.style="margin-left:5px;margin-right:5px;"),e}L();console.log("srd end :>> ");const he={class:"w-[500px] px-4 py-5 text-center text-gray-700"},ke=a("label",{for:"docLink",class:"block text-left mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Ссылка",-1),xe={class:"block m-4"},ye={key:0,class:"px-3 pb-3 mt-3 border-dotted border-sky-300 border-1 rounded-md"},ve=a("label",{for:"docPin",class:"block text-left my-2 text-sm font-medium text-gray-900 dark:text-white"},"Индекс",-1),we=a("label",{for:"docIndex",class:"block text-left my-2 text-sm font-medium text-gray-900 dark:text-white"},"Тип",-1),Ce=a("label",{for:"docType",class:"block text-left my-2 text-sm font-medium text-gray-900 dark:text-white"},"ПИН",-1),$e={class:"block m-4"},Se=B({__name:"Popup",setup(n){function e(){console.log("opened options"),D.runtime.openOptionsPage()}return(r,t)=>{const o=se,d=ae,p=E,k=ee,x=G,m=F;return c(),s("main",he,[a("button",{class:"absolute icon-btn mt-2 mx-2 text-2xl right-0 top-0",onClick:e},[u(o)]),u(d),u(p),ke,b(a("input",{type:"text",placeholder:"http://*.advance-docs.ru/...",id:"docLink","onUpdate:modelValue":t[0]||(t[0]=l=>_(g)?g.value=l:null),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},null,512),[[f,i(g)]]),a("div",xe,[a("button",{type:"button",class:"inline-flex focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800",onClick:t[1]||(t[1]=l=>i(A)(i(g)))},[u(k),y("Отправить")]),a("button",{type:"button",class:"inline-flex text-blue-700 hover:text-white border border-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center me-2 mb-2 dark:border-blue-500 dark:text-blue-500 dark:hover:text-white dark:hover:bg-blue-500 dark:focus:ring-blue-800",onClick:t[2]||(t[2]=l=>i(be)(i(g)))},[u(x),y("Скачать")])]),i(T)?(c(),s("div",ye,[ve,b(a("input",{placeholder:"ПИН",id:"docPin","onUpdate:modelValue":t[3]||(t[3]=l=>_(v)?v.value=l:null),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},null,512),[[f,i(v)]]),we,b(a("input",{placeholder:"Индекс",id:"docIndex","onUpdate:modelValue":t[4]||(t[4]=l=>_(w)?w.value=l:null),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},null,512),[[f,i(w)]]),Ce,b(a("input",{placeholder:"Тип",id:"docType","onUpdate:modelValue":t[5]||(t[5]=l=>_(C)?C.value=l:null),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},null,512),[[f,i(C)]])])):I("",!0),a("div",$e,[i(T)?(c(),s("button",{key:0,type:"button",class:"inline-flex text-blue-700 hover:text-white border border-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center me-2 mb-2 dark:border-blue-500 dark:text-blue-500 dark:hover:text-white dark:hover:bg-blue-500 dark:focus:ring-blue-800",onClick:t[6]||(t[6]=(...l)=>r.signDocument&&r.signDocument(...l))},[u(m),y(" Подписать")])):I("",!0)])])}}}),V=M(Se);U(V);V.mount("#app");
